# Как внести свой вклад в проект

## Подготовка рабочего пространства

1. Создайте форк репозитория.
2. Клонируйте свой форк: \
	`git clone %url_repo%` \
	или с подмодулями, если собираетесь работать с играми в каталоге, \
	`git clone --recurse-submodules %url_repo%`
3. Установите зависимости проекта: \
	`npm install`

## Процесс внесения изменений

1. Создайте новую ветку (branch).
2. Внесите изменения с учётом следующего:
	* Задокументируйте изменения в файле [CHANGELOG.md](CHANGELOG.md) в разделе версии со статусом "в разработке". Если изменения являются мелкими техническими правками или уже соответствуют одному из пунктов списка, то их можно не документировать. Если они сильно похожи на один из пунктов, то можно переписать этот пункт с обобщающей формулировкой изменений.
	* Если изменения затрагивают функциональность, которая уже документирована в прошлой реализации или является значимым изменением и должна быть документирована, то внесите соответствующие правки или дополнения в файлы [README.md](README.md) и/или [docs/urql.html](docs/urql.html).
3. Сделайте фиксацию изменений (commit).
4. Создайте запрос на вытягивание (pull request)

## Добавление или обновление игры

Рекомендованным способом добавления игр в каталог и последующего их сопровождения является подключение их репозиториев как подмодулей Git в основном репозитории UrqW.

Выполняйте операцию как любое другое внесение изменений (см. [Процесс внесения изменений](#процесс-внесения-изменений)).

Добавление новой игры:

1. Подготовьте внешний репозиторий с игрой в соответствии со следующими требованиями:
	* Репозиторий игры должен содержать файл manifest.json для UrqW в корректном формате, расположенный либо в корневой директории, либо в директории максимум с одним уровнем вложенности.
	* Репозиторий игры должен содержать минимум 1 файл .qst с кодом игры.
	* Репозиторий игры может содержать другие файлы, необходимые для пакета игры.
	* Крайне желательно, чтобы репозиторий игры не содержал файлов, в названии которых есть не ASCII-символы.
2. Добавьте внешний репозиторий с игрой как подмодуль Git в директорию games основного репозитория UrqW: \
	`git submodule add %url_game_repo% games/%game_name%` \
	Название директории игры (%game_name%) следует оформлять в стиле snake_case: ASCII-символы в нижнем регистре, если надо, разделённые символом подчёркивания.
3. Добавьте информацию о новой игре в файл games.json в основном репозитории UrqW.
4. Проверьте валидность отредактированного файла games.json, запустив скрипт: \
	`npm run validate-games.json`
5. Упакуйте игру в виде архива в директории quests основного репозитория UrqW, запустив скрипт: \
	`npm run package-game -- %game_name%`
6. Завершите внесение изменений в основной репозиторий UrqW в соответствии с [общим процессом](#процесс-внесения-изменений).

Обновление уже добавленной игры:

1. Обновите подключённый подмодуль игры: \
	`git submodule update --remote games/%game_name%` \
	или \
	`git submodule update --recursive --remote games/%game_name%` \
	если репозиторий игры сам содержит подмодули.
2. Перепакуйте игру в виде архива в директории quests основного репозитория UrqW, запустив скрипт: \
	`npm run package-game -- %game_name%`
3. Завершите внесение изменений в основной репозиторий UrqW в соответствии с [общим процессом](#процесс-внесения-изменений).

## Подготовка новой версии

1. Актуализируйте и синхронизируйте версию UrqW в следующих файлах проекта:
	* В переменной urqw_version в файле [/js/Player.js](/js/Player.js)
	* В параметре version в файле [package.json](package.json)
	* В файле [package-lock.json](package-lock.json), автоматически обновив его после редактирования [package.json](package.json) командой `npm install`
2. Отредактируйте файл [CHANGELOG.md](CHANGELOG.md):
	* Если это начало разработки новой версии, то в журнале изменений должна должен быть создан новый раздел с номером подготавливаемой версии и указанием статуса "В разработке", например, "Версия 1.0 (в разработке)".
	* Если это подготовка релиза, то в журнале изменений должен быть раздел с номером выпускаемой версии и указанием даты выпуска вместо статуса "в разработке", например, "Версия 1.0 от 20.01.2017".
3. Выполните прочие необходимые действия.
